#!/usr/bin/python
#pip install scapy
import sys
from datetime import datetime
from scapy.all import srp,Ether,ARP,conf
class red():
  direccion={'ip':'','interface':'eth0'}
  def __init__(self, ip,interface):
    self.direccion['ip']=ip
    self.direccion['interface']=interface
  def arp(self):
    try:
      conf.verb = 0
      print self.direccion
      ans, unans = srp(Ether(dst="ff:ff:ff:ff:ff:ff")/ARP(pdst = str(self.direccion["ip"])), timeout = 2, iface=str(self.direccion["interface"]),inter=0.1)
      print "MAC - IP\n" 
      for snd,rcv in ans:
        print rcv.sprintf(r"IP activo: %ARP.psrc%")

    except Exception, e:
      raise e

if len(sys.argv) == 3:
  host=str(sys.argv[1])
  interface=str(sys.argv[2])
  escaneo=red(host,interface)
else:
  print "  "+str(sys.argv[0])+" host [interface]"
  print "    host: segmento a escanear ejemplo: <192.168.0.0/24> "
  print "    interface: tarjeta de red por donde escaneara"
  exit()

escaneo.arp()